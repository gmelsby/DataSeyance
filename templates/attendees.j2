{% extends 'baselayout.html' %}

{% block title %}Attendees{% endblock %}
{% block content %}
<div class="container-fluid">
<table class="table table-striped">
  <caption>Attendees</caption>
  <thead>
  <tr>
    <th>attendee_id</th>
    <th>Full Name</th>
    <th>Action</th>
    <th>Delete</th>
  </tr>
  </thead>
  <tbody>
  {% for attendee in attendee_data %}
     {%if attendee['attendee_id'] == edit_form %}

  <tr>
  <form id="UpdateAttendee" method="POST">
  <td>{{attendee['attendee_id']}}  </td>
  <td><form id="UpdateSpirit" method="POST">
  <input  type="text" class="form-control" name="new_name" value='{{attendee['full_name']}}'></td>
    <td><input class="btn btn-primary" type="submit" id="SaveUpdateAttendee" value="Save">
     <input type="hidden" name="id_input" value={{attendee['attendee_id']}}>
   <input type="hidden" name="action" value="update">
   <input type="hidden" name="edit_form" value=-1>
    </td>
   </form>
    <td>
       <form id="cancel" method="GET">
      <input class="btn btn-secondary" type="submit" id="cancel" value="Cancel">
     </td>
        </form>

  </tr>

     {% else %}
  <tr>
    <td>{{attendee['attendee_id']}}</td>
    <td>{{attendee['full_name']}}</td>

    <td>
      <form id="UpdateSpirit" method="POST">
        <input class="btn btn-secondary" type="submit" id="UpdateAttendee" value="Update Attendee">
        <input type="hidden" name="action" value="tagupdate">
        <input type="hidden" name="id_input" value={{attendee['attendee_id']}}
        <input type="hidden" name="edit_form" value={{attendee['attendee_id']}}
    </td>
    </form>


    <td>
        <form id="DeleteAttendee" method="POST">
        <input class="btn btn-danger" type="submit" id="DeleteAttendee" value="Delete Attendee">
        <input type="hidden" name="action" value="delete">
        <input type="hidden" name="attendee_id" value={{attendee['attendee_id']}}
   </td>    </form>
  </tr>

    {% endif %}
  {% endfor %}

  <tr>
  <div class="form-group">
  <form id="InsertAttendee" method="POST">
    <td>Insert New Attendee</td>
    <td><input type="text" class="form-control" name="insert_full_name"></td>
    <td colspan=2>   <input class="btn btn-dark" type="submit" id="InsertAttendee" value="Insert Attendee">
         <input type="hidden" name="action" value="insert">
   </td>
  </form>
  </div>
</tr>

  </tbody>
</table>


<div id="insert" style="display: block">
  <form id="InsertAttendee" method="POST">
     <legend><strong>Insert Attendee</strong></legend>
     <fieldset class="fields">
     <label> Full Name: </label> <input type="text"  name="name">
     <label for="seance_id">Has this attendee already attended a seance? If not, have them attend one to be inducted.</label>
     <select name="seance_id" id="seance_id_select">
    {% for seance in seance_data %}
    <option value={{seance['seance_id']}}>
    {{seance['date']}} at {{seance['name']}} | seance_id: {{seance['seance_id']}}</option>
    {% endfor %}
  </select>
    </fieldset>
    <input  class="btn btn-dark"  type="submit" id="InsertAttendee" value="Insert Attendee">
  </form>
</div>

<div>
&nbsp;
</div>

<div id="update" style="display: block">
  <form id="UpdateAttendee" method="POST">
    <legend><strong>Update Attendee</strong></legend>
    <label for="id_input">Attendee to Update: </label>
    <select name="id_input" id="id_input">
      <option value=""> </option>
      {% for attendee in attendee_data %}
      <option value={{attendee['attendee_id']}}
      {% if attendee_to_edit['attendee_id']==attendee['attendee_id'] %} selected {% endif %}>
        {{attendee['full_name']}} | id: {{attendee['attendee_id']}}
      </option>
      {% endfor %}
    </select>
    <fieldset class="fields">
    <legend>New Information</legend>
    <label> Full Name: </label> <input  type="text"  name="new_name" value="{{attendee_to_edit['full_name']}}">
    </fieldset>
    <input   class="btn btn-dark" type="submit" id="UpdateAttendee" value="Update Attendee">
  </form>
</div>
</div>

{% endblock %}